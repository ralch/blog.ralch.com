<!doctype html><html lang=en dir=auto>
<head><meta charset=utf-8>
<meta http-equiv=x-ua-compatible content="IE=edge">
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=robots content="index, follow">
<title>Object relation mapping with GORM | Svetlin Ralchev | Blog</title>
<meta name=keywords content>
<meta name=description content="What is object-relation mapping (ORM, O/RM, and O/R mapping)?  Object-relational mapping in computer science is a programming technique for converting data between incompatible type systems in object-oriented programming languages. This creates, in effect, a &ldquo;virtual object database&rdquo; that can be used from within the programming language.
 source: Wikipedia
What is GORM? GORM is object-relation package for Go. It supports the following databases:
 FoundationDB PostgreSQL MySQL SQLite  Installation It is easy to install by invoking go get command:">
<meta name=author content="Svetlin Ralchev">
<link rel=canonical href=http://blog.ralch.com/articles/golang-object-relation-mapping-with-gorm/>
<link crossorigin=anonymous href=/assets/css/stylesheet.min.5e2b4101351c21e906f398ae96901791830f58d430f96f2659dab7eaef7b3cb7.css integrity="sha256-XitBATUcIekG85iulpAXkYMPWNQw+W8mWdq36u97PLc=" rel="preload stylesheet" as=style>
<link rel=preload href=/logo.png as=image>
<script defer crossorigin=anonymous src=/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5+kdJvBz5iKbt6B5PJI=" onload=hljs.initHighlightingOnLoad()></script>
<link rel=icon href=http://blog.ralch.com/favicon.ico>
<link rel=icon type=image/png sizes=16x16 href=http://blog.ralch.com/favicon-16x16.png>
<link rel=icon type=image/png sizes=32x32 href=http://blog.ralch.com/favicon-32x32.png>
<link rel=apple-touch-icon href=http://blog.ralch.com/apple-touch-icon.png>
<link rel=mask-icon href=http://blog.ralch.com/safari-pinned-tab.svg>
<meta name=theme-color content="#2e2e33">
<meta name=msapplication-TileColor content="#2e2e33">
<meta name=generator content="Hugo 0.88.1">
<noscript>
<style>#theme-toggle,.top-link{display:none}</style>
<style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style>
</noscript>
<script type=application/javascript>var doNotTrack=!1;doNotTrack||(function(a,e,f,g,b,c,d){a.GoogleAnalyticsObject=b,a[b]=a[b]||function(){(a[b].q=a[b].q||[]).push(arguments)},a[b].l=1*new Date,c=e.createElement(f),d=e.getElementsByTagName(f)[0],c.async=1,c.src=g,d.parentNode.insertBefore(c,d)}(window,document,'script','https://www.google-analytics.com/analytics.js','ga'),ga('create','UA-62134307-2','auto'),ga('send','pageview'))</script><meta property="og:title" content="Object relation mapping with GORM">
<meta property="og:description" content="What is object-relation mapping (ORM, O/RM, and O/R mapping)?  Object-relational mapping in computer science is a programming technique for converting data between incompatible type systems in object-oriented programming languages. This creates, in effect, a &ldquo;virtual object database&rdquo; that can be used from within the programming language.
 source: Wikipedia
What is GORM? GORM is object-relation package for Go. It supports the following databases:
 FoundationDB PostgreSQL MySQL SQLite  Installation It is easy to install by invoking go get command:">
<meta property="og:type" content="article">
<meta property="og:url" content="http://blog.ralch.com/articles/golang-object-relation-mapping-with-gorm/"><meta property="article:section" content="articles">
<meta property="article:published_time" content="2015-11-15T08:54:02+00:00">
<meta property="article:modified_time" content="2015-11-15T08:54:02+00:00">
<meta name=twitter:card content="summary">
<meta name=twitter:title content="Object relation mapping with GORM">
<meta name=twitter:description content="What is object-relation mapping (ORM, O/RM, and O/R mapping)?  Object-relational mapping in computer science is a programming technique for converting data between incompatible type systems in object-oriented programming languages. This creates, in effect, a &ldquo;virtual object database&rdquo; that can be used from within the programming language.
 source: Wikipedia
What is GORM? GORM is object-relation package for Go. It supports the following databases:
 FoundationDB PostgreSQL MySQL SQLite  Installation It is easy to install by invoking go get command:">
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":2,"name":"Articles","item":"http://blog.ralch.com/articles/"},{"@type":"ListItem","position":3,"name":"Object relation mapping with GORM","item":"http://blog.ralch.com/articles/golang-object-relation-mapping-with-gorm/"}]}</script>
<script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Object relation mapping with GORM","name":"Object relation mapping with GORM","description":"What is object-relation mapping (ORM, O/RM, and O/R mapping)?  Object-relational mapping in computer science is a programming technique for converting data between incompatible type systems in object-oriented programming languages. This creates, in effect, a \u0026ldquo;virtual object database\u0026rdquo; that can be used from within the programming language.\n source: Wikipedia\nWhat is GORM? GORM is object-relation package for Go. It supports the following databases:\n FoundationDB PostgreSQL MySQL SQLite  Installation It is easy to install by invoking go get command:","keywords":[],"articleBody":"What is object-relation mapping (ORM, O/RM, and O/R mapping)?  Object-relational mapping in computer science is a programming technique for converting data between incompatible type systems in object-oriented programming languages. This creates, in effect, a “virtual object database” that can be used from within the programming language.\n source: Wikipedia\nWhat is GORM? GORM is object-relation package for Go. It supports the following databases:\n FoundationDB PostgreSQL MySQL SQLite  Installation It is easy to install by invoking go get command:\n$ go get -u github.com/jinzhu/gorm Model declaration Models in GORM are a simple Go structs that declare a set of public fields. Every model is representent as table and every field is column in this table.\nIn this blog we will define all models illustrated on the following diagram:\n  The actual representation of the diagram are three structs. Each of them has different fields that define a database column mapping via sql and gorm tags. In this examples, we will explore some of them.\ntype Company struct { ID int `sql:\"AUTO_INCREMENT\" gorm:\"primary_key\"` Name string `sql:\"size:255;unique;index\"` Employees []Employee // one-to-many relationship Address Address // one-to-one relationship } The Company struct has an auto incremental primary key defined by sql:\"AUTO_INCREMENT\" gorm:\"primary_key\".\nIts string Name field should contain a value that is unique for all rows in the Company table. The column is indexed, which improves the performance on any queries that uses it in their where clause.\nGORM automatically creates for the rest of the fields:\n one-to-many relationship between Company and Employee one to one relationship between Company and Address tables  type Employee struct { FirstName string `sql:\"size:255;index:name_idx\"` LastName string `sql:\"size:255;index:name_idx\"` SocialSecurityNo string `sql:\"type:varchar(100);unique\" gorm:\"column:ssn\"` DateOfBirth time.Time `sql:\"DEFAULT:current_timestamp\"` Address *Address // one-to-one relationship Deleted bool `sql:\"DEFAULT:false\"` } The Employee struct is defined in similar to way.\nThe FirstName and LastName field have maximum length 255. In additionl a name_idx index is created for both fields.\nThe SocialSecurityNo field is renamed to ssn column (by declaring gorm:\"column:ssn tag) that has values that should be unique and do not exceed 100 characters.\nThe Employee struct has one-to-one relationship with the Address struct.\nThe fields DateOfBirth and Deleted has default values declared by sql:\"DEFAULT:\" tag. For the DateOfBirth column we are using the postgres function current_timestamp to set the default value.\ntype Address struct { Country string `gorm:\"primary_key\"` City string `gorm:\"primary_key\"` PostCode string `gorm:\"primary_key\"` Line1 sql.NullString Line2 sql.NullString } The Address struct has a primary key that consists three fields Country, City and PostCode. In fact it has two columns Line1 and Line2 that are using sql.NullString type to allow null values.\nIn order to access your database you should open a new connection to it. In this article I am using PostgreSQL. Therefore, any thoughts will be related to PostgreSQL and relational databases.\nYou should install its driver for GO with the following command:\nEstablishing connection $ go get \"github.com/lib/pq\" The driver should be registered to make it available for GORM:\nimport _ \"github.com/lib/pq\" Then we should establish the connection:\ndb, err := gorm.Open(\"postgres\", \"postgresql://myapp:dbpass@localhost:15432/myapp\") if err != nil { panic(err) } // Ping function checks the database connectivity err = db.DB().Ping() if err != nil { panic(err) } Creating tables Every struct type is presented as a table in the underlying database. Respectively every property is represented as a column in the database table.\nLets create the declared models by invoking db.CreateTable function:\ndb.CreateTable(\u0026company.Address{}) db.CreateTable(\u0026company.Company{}) db.CreateTable(\u0026company.Employee{}) The function will create underlying tables if they do not exists. They have a schema based on the property definitions. A properties that contain int sql:\"-\"` tag are not emitted as a table columns.\nBy default the created table names are in plural. If you want to disable that you should use the following code snippet before any table create and table migrate task.\ndb.SingularTable(true) Migrating tables If you want to change an existing table schema for your models, GORM provides a set of features. You could automatically use the AutoMigrate function to migrate the existing database schema to the new model changes.\ndb.AutoMigrate(\u0026company.Address{}) db.AutoMigrate(\u0026company.Company{}) db.AutoMigrate(\u0026company.Employee{}) Unfortunately, the migration adds only a new columns and new indexes, but does not alter existing columns and existing indexes.\nIf you want to do that you should use the functions provided by gorm.Model object.\n ModifyColumn change columns type DropColumn drops an existing column AddIndex creates an index AddUniqueIndex creates a unique index RemoveIndex removes an existings index  Lets change the Name columns type of Company table to a text:\ndb.Model(\u0026company.Company{}).ModifyColumn(\"name\", \"text\") Dropping tables Tables could be dropped by using db.DropTable function:\ndb.DropTable(\u0026company.Address{}) db.DropTable(\u0026company.Company{}) db.DropTable(\u0026company.Employee{}) The operation destroys the tables schema and all records.\nCreate, Update and Delete records In this section we will explore the CRUD operations for this company:\nsampleCompany := company.Company{ Name: \"Google\", Address: company.Address{ Country: \"USA\", City: \"Moutain View\", PostCode: \"1600\", }, Employees: []company.Employee{ company.Employee{ FirstName: \"John\", LastName: \"Doe\", SocialSecurityNo: \"00-000-0000\", }, }, } Create Lets create an new company by executing the db.Create function:\n// It creates a single Company record and all associations (Address and Employees) db.Create(\u0026sampleCompany) Delete To delete the created company, you should use db.Delete function:\ndb.Delete(\u0026sampleCompany) You could do a batch delete. In the following example we are deleting all companies that contains letter G in their name:\ndb.Where(\"Name LIKE ?\", \"%G%\").Delete(company.Company{}) Update To update an existing record you should simple change its property and use db.Save command to persist the change:\nmodel.Country = \"USA\" db.Save(\u0026sampleCompany) For batch updates we should use simiplar to Delete operation approach, but this time we should use Updates function instead. Lets update all USA addresses:\ndb.Table(\"addresses\").Where(\"Country = ?\", \"USA\").Updates(map[string]interface{}{\"Country\": \"North America\"}) Query data records GORM provides a very intuitive way to query your data. It brings all power of underlying database by providing the following functions:\nvar firstComp company.Company // fetch a company by primary key db.First(\u0026firstComp, 1) // fetch a company by name db.Find(\u0026firstComp, \"name = ?\", \"Google\") // fetch all companies var comapnies []company.Company db.Find(\u0026companies) // fetch all companies that starts with G db.Where(\"name = ?\", \"%G%\").Find(\u0026companies) I cannot manage to cover in a single post. You can read more about them in the official documentation.\nConclusion GORM is great object relation mapping package that unifies the access to different data base. The provides all query capabilities that we are familiar with in SQL like languages. I would like to see a code generation package that generates a models from existing data base.\n","wordCount":"1056","inLanguage":"en","datePublished":"2015-11-15T08:54:02Z","dateModified":"2015-11-15T08:54:02Z","author":{"@type":"Person","name":"Svetlin Ralchev"},"mainEntityOfPage":{"@type":"WebPage","@id":"http://blog.ralch.com/articles/golang-object-relation-mapping-with-gorm/"},"publisher":{"@type":"Organization","name":"Svetlin Ralchev | Blog","logo":{"@type":"ImageObject","url":"http://blog.ralch.com/favicon.ico"}}}</script>
</head>
<body id=top>
<script>window.matchMedia('(prefers-color-scheme: dark)').matches&&document.body.classList.add('dark')</script>
<header class=header>
<nav class=nav>
<div class=logo>
<a href=http://blog.ralch.com accesskey=h title="Svetlin Ralchev (Alt + H)">
<img src=/logo.png alt=logo aria-label=logo height=35>Svetlin Ralchev</a>
<span class=logo-switches>
</span>
</div>
<ul id=menu>
<li>
<a href=http://blog.ralch.com/archives title=Archive>
<span>Archive</span>
</a>
</li>
<li>
<a href=http://blog.ralch.com/tags/ title=Tags>
<span>Tags</span>
</a>
</li>
<li>
<a href=http://blog.ralch.com/categories/ title=Categories>
<span>Categories</span>
</a>
</li>
</ul>
</nav>
</header>
<main class=main>
<article class=post-single>
<header class=post-header>
<div class=breadcrumbs><a href=http://blog.ralch.com>Home</a>&nbsp;»&nbsp;<a href=http://blog.ralch.com/articles/>Articles</a></div>
<h1 class=post-title>
Object relation mapping with GORM
</h1>
<div class=post-meta>November 15, 2015&nbsp;·&nbsp;5 min&nbsp;·&nbsp;Svetlin Ralchev
</div>
</header> <div class=toc>
<details>
<summary accesskey=c title="(Alt + C)">
<span class=details>Table of Contents</span>
</summary>
<div class=inner><ul>
<li>
<a href=#what-is-object-relation-mapping-orm-orm-and-or-mapping aria-label="What is object-relation mapping (ORM, O/RM, and O/R mapping)?">What is object-relation mapping (ORM, O/RM, and O/R mapping)?</a></li>
<li>
<a href=#what-is-gorm aria-label="What is GORM?">What is GORM?</a><ul>
<li>
<a href=#installation aria-label=Installation>Installation</a></li>
<li>
<a href=#model-declaration aria-label="Model declaration">Model declaration</a></li></ul>
</li>
<li>
<a href=#establishing-connection aria-label="Establishing connection">Establishing connection</a><ul>
<li>
<a href=#creating-tables aria-label="Creating tables">Creating tables</a></li>
<li>
<a href=#migrating-tables aria-label="Migrating tables">Migrating tables</a></li>
<li>
<a href=#dropping-tables aria-label="Dropping tables">Dropping tables</a></li>
<li>
<a href=#create-update-and-delete-records aria-label="Create, Update and Delete records">Create, Update and Delete records</a><ul>
<li>
<a href=#create aria-label=Create>Create</a></li>
<li>
<a href=#delete aria-label=Delete>Delete</a></li>
<li>
<a href=#update aria-label=Update>Update</a></li></ul>
</li>
<li>
<a href=#query-data-records aria-label="Query data records">Query data records</a></li></ul>
</li>
<li>
<a href=#conclusion aria-label=Conclusion>Conclusion</a>
</li>
</ul>
</div>
</details>
</div>
<div class=post-content><h3 id=what-is-object-relation-mapping-orm-orm-and-or-mapping>What is object-relation mapping (ORM, O/RM, and O/R mapping)?<a hidden class=anchor aria-hidden=true href=#what-is-object-relation-mapping-orm-orm-and-or-mapping>#</a></h3>
<blockquote>
<p>Object-relational mapping in computer science is a programming technique for
converting data between incompatible type systems in object-oriented
programming languages. This creates, in effect, a &ldquo;virtual object database&rdquo;
that can be used from within the programming language.</p>
</blockquote>
<p><em>source: <a href=https://en.wikipedia.org/wiki/Object-relational_mapping>Wikipedia</a></em></p>
<h3 id=what-is-gorm>What is GORM?<a hidden class=anchor aria-hidden=true href=#what-is-gorm>#</a></h3>
<p><a href=https://github.com/jinzhu/gorm>GORM</a> is object-relation package for <code>Go</code>. It
supports the following databases:</p>
<ul>
<li><a href=http://www.foundationdb.com>FoundationDB</a></li>
<li><a href=http://www.postgresql.org>PostgreSQL</a></li>
<li><a href=http://dev.mysql.com>MySQL</a></li>
<li><a href=https://www.sqlite.org>SQLite</a></li>
</ul>
<h4 id=installation>Installation<a hidden class=anchor aria-hidden=true href=#installation>#</a></h4>
<p>It is easy to install by invoking <code>go get</code> command:</p>
<pre tabindex=0><code>$ go get -u github.com/jinzhu/gorm
</code></pre><h4 id=model-declaration>Model declaration<a hidden class=anchor aria-hidden=true href=#model-declaration>#</a></h4>
<p>Models in <code>GORM</code> are a simple <code>Go</code> structs that declare a set of public fields.
Every model is representent as table and every field is column in this table.</p>
<p>In this blog we will define all models illustrated on the following diagram:</p>
<figure>
<img loading=lazy src=/media/golang/gorm-diagram.png alt="ORM Diagram">
</figure>
<p>The actual representation of the diagram are three structs. Each of them has
different fields that define a database column mapping via <code>sql</code> and <code>gorm</code>
<a href=https://golang.org/pkg/reflect/#example_StructTag>tags</a>. In this examples, we
will explore some of them.</p>
<pre tabindex=0><code>type Company struct {
	ID        int        `sql:&quot;AUTO_INCREMENT&quot; gorm:&quot;primary_key&quot;`
	Name      string     `sql:&quot;size:255;unique;index&quot;`
	Employees []Employee // one-to-many relationship
	Address   Address    // one-to-one relationship
}
</code></pre><p>The <code>Company</code> struct has an auto incremental primary key defined by
<code>sql:"AUTO_INCREMENT" gorm:"primary_key"</code>.</p>
<p>Its string <code>Name</code> field should contain a value that is unique for all rows in
the <code>Company</code> table. The column is indexed, which improves the performance on
any queries that uses it in their <code>where</code> clause.</p>
<p><code>GORM</code> automatically creates for the rest of the fields:</p>
<ul>
<li>one-to-many relationship between <code>Company</code> and <code>Employee</code></li>
<li>one to one relationship between <code>Company</code> and <code>Address</code> tables</li>
</ul>
<pre tabindex=0><code>type Employee struct {
	FirstName        string    `sql:&quot;size:255;index:name_idx&quot;`
	LastName         string    `sql:&quot;size:255;index:name_idx&quot;`
	SocialSecurityNo string    `sql:&quot;type:varchar(100);unique&quot; gorm:&quot;column:ssn&quot;`
	DateOfBirth      time.Time `sql:&quot;DEFAULT:current_timestamp&quot;`
	Address          *Address  // one-to-one relationship
	Deleted          bool      `sql:&quot;DEFAULT:false&quot;`
}
</code></pre><p>The <code>Employee</code> struct is defined in similar to way.</p>
<p>The <code>FirstName</code> and <code>LastName</code> field have maximum length 255. In additionl a
<code>name_idx</code> index is created for both fields.</p>
<p>The <code>SocialSecurityNo</code> field is
renamed to <code>ssn</code> column (by declaring <code>gorm:"column:ssn</code> tag) that has values
that should be unique and do not exceed 100 characters.</p>
<p>The <code>Employee</code> struct has one-to-one relationship with the <code>Address</code> struct.</p>
<p>The fields <code>DateOfBirth</code> and <code>Deleted</code> has default values declared by
<code>sql:"DEFAULT:&lt;default_value>"</code> tag. For the <code>DateOfBirth</code> column we are using
the postgres function <code>current_timestamp</code> to set the default value.</p>
<pre tabindex=0><code>type Address struct {
	Country  string `gorm:&quot;primary_key&quot;`
	City     string `gorm:&quot;primary_key&quot;`
	PostCode string `gorm:&quot;primary_key&quot;`
	Line1    sql.NullString
	Line2    sql.NullString
}
</code></pre><p>The <code>Address</code> struct has a primary key that consists three fields <code>Country</code>, <code>City</code>
and <code>PostCode</code>. In fact it has two columns <code>Line1</code> and <code>Line2</code> that are using
<code>sql.NullString</code> type to allow null values.</p>
<p>In order to access your database you should open a new connection to it. In this
article I am using <code>PostgreSQL</code>. Therefore, any thoughts will be related to
<code>PostgreSQL</code> and relational databases.</p>
<p>You should install its driver for <code>GO</code> with the following command:</p>
<h3 id=establishing-connection>Establishing connection<a hidden class=anchor aria-hidden=true href=#establishing-connection>#</a></h3>
<pre tabindex=0><code>$ go get &quot;github.com/lib/pq&quot;
</code></pre><p>The driver should be registered to make it available for <code>GORM</code>:</p>
<pre tabindex=0><code>import _ &quot;github.com/lib/pq&quot;
</code></pre><p>Then we should establish the connection:</p>
<pre tabindex=0><code>db, err := gorm.Open(&quot;postgres&quot;, &quot;postgresql://myapp:dbpass@localhost:15432/myapp&quot;)
if err != nil {
	panic(err)
}

// Ping function checks the database connectivity
err = db.DB().Ping()
if err != nil {
	panic(err)
}
</code></pre><h4 id=creating-tables>Creating tables<a hidden class=anchor aria-hidden=true href=#creating-tables>#</a></h4>
<p>Every struct type is presented as a table in the underlying database. Respectively
every property is represented as a column in the database table.</p>
<p>Lets create the declared models by invoking <code>db.CreateTable</code> function:</p>
<pre tabindex=0><code>db.CreateTable(&amp;company.Address{})
db.CreateTable(&amp;company.Company{})
db.CreateTable(&amp;company.Employee{})
</code></pre><p>The function will create underlying tables if they do not exists. They have a schema
based on the property definitions. A properties that contain <code>int </code>sql:"-"` tag
are not emitted as a table columns.</p>
<p>By default the created table names are in plural. If you want to disable that
you should use the following code snippet before any table create and table
migrate task.</p>
<pre tabindex=0><code>db.SingularTable(true)
</code></pre><h4 id=migrating-tables>Migrating tables<a hidden class=anchor aria-hidden=true href=#migrating-tables>#</a></h4>
<p>If you want to change an existing table schema for your models, <code>GORM</code> provides
a set of features. You could automatically use the <code>AutoMigrate</code> function to
migrate the existing database schema to the new model changes.</p>
<pre tabindex=0><code>db.AutoMigrate(&amp;company.Address{})
db.AutoMigrate(&amp;company.Company{})
db.AutoMigrate(&amp;company.Employee{})
</code></pre><p>Unfortunately, the migration adds only a new columns and new indexes, but does
not alter existing columns and existing indexes.</p>
<p>If you want to do that you should use the functions provided by <code>gorm.Model</code>
object.</p>
<ul>
<li><code>ModifyColumn</code> change columns type</li>
<li><code>DropColumn</code> drops an existing column</li>
<li><code>AddIndex</code> creates an index</li>
<li><code>AddUniqueIndex</code> creates a unique index</li>
<li><code>RemoveIndex</code> removes an existings index</li>
</ul>
<p>Lets change the <code>Name</code> columns type of <code>Company</code> table to a <code>text</code>:</p>
<pre tabindex=0><code>db.Model(&amp;company.Company{}).ModifyColumn(&quot;name&quot;, &quot;text&quot;)
</code></pre><h4 id=dropping-tables>Dropping tables<a hidden class=anchor aria-hidden=true href=#dropping-tables>#</a></h4>
<p>Tables could be dropped by using <code>db.DropTable</code> function:</p>
<pre tabindex=0><code>db.DropTable(&amp;company.Address{})
db.DropTable(&amp;company.Company{})
db.DropTable(&amp;company.Employee{})
</code></pre><p>The operation destroys the tables schema and all records.</p>
<h4 id=create-update-and-delete-records>Create, Update and Delete records<a hidden class=anchor aria-hidden=true href=#create-update-and-delete-records>#</a></h4>
<p>In this section we will explore the <code>CRUD</code> operations for this company:</p>
<pre tabindex=0><code>sampleCompany := company.Company{
	Name: &quot;Google&quot;,
	Address: company.Address{
		Country:  &quot;USA&quot;,
		City:     &quot;Moutain View&quot;,
		PostCode: &quot;1600&quot;,
	},
	Employees: []company.Employee{
		company.Employee{
			FirstName:        &quot;John&quot;,
			LastName:         &quot;Doe&quot;,
			SocialSecurityNo: &quot;00-000-0000&quot;,
		},
	},
}
</code></pre><h5 id=create>Create<a hidden class=anchor aria-hidden=true href=#create>#</a></h5>
<p>Lets create an new company by executing the <code>db.Create</code> function:</p>
<pre tabindex=0><code>// It creates a single Company record and all associations (Address and Employees)
db.Create(&amp;sampleCompany)
</code></pre><h5 id=delete>Delete<a hidden class=anchor aria-hidden=true href=#delete>#</a></h5>
<p>To delete the created company, you should use <code>db.Delete</code> function:</p>
<pre tabindex=0><code>db.Delete(&amp;sampleCompany)
</code></pre><p>You could do a batch delete. In the following example we are deleting all companies
that contains letter <code>G</code> in their name:</p>
<pre tabindex=0><code>db.Where(&quot;Name LIKE ?&quot;, &quot;%G%&quot;).Delete(company.Company{})
</code></pre><h5 id=update>Update<a hidden class=anchor aria-hidden=true href=#update>#</a></h5>
<p>To update an existing record you should simple change its property and use
<code>db.Save</code> command to persist the change:</p>
<pre tabindex=0><code>model.Country = &quot;USA&quot;
db.Save(&amp;sampleCompany)
</code></pre><p>For batch updates we should use simiplar to <code>Delete</code> operation approach, but this
time we should use <code>Updates</code> function instead. Lets update all <code>USA</code> addresses:</p>
<pre tabindex=0><code>db.Table(&quot;addresses&quot;).Where(&quot;Country = ?&quot;, &quot;USA&quot;).Updates(map[string]interface{}{&quot;Country&quot;: &quot;North America&quot;})
</code></pre><h4 id=query-data-records>Query data records<a hidden class=anchor aria-hidden=true href=#query-data-records>#</a></h4>
<p><code>GORM</code> provides a very intuitive way to query your data. It brings all power of
underlying database by providing the following functions:</p>
<pre tabindex=0><code>var firstComp company.Company

// fetch a company by primary key
db.First(&amp;firstComp, 1)

// fetch a company by name
db.Find(&amp;firstComp, &quot;name = ?&quot;, &quot;Google&quot;)

// fetch all companies
var comapnies []company.Company
db.Find(&amp;companies)

// fetch all companies that starts with G
db.Where(&quot;name = ?&quot;, &quot;%G%&quot;).Find(&amp;companies)
</code></pre><p>I cannot manage to cover in a single post. You can read more about them in the
<a href=https://github.com/jinzhu/gorm>official documentation</a>.</p>
<h3 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h3>
<p><code>GORM</code> is great object relation mapping package that unifies the access to
different data base. The provides all query capabilities that we are familiar
with in <code>SQL</code> like languages. I would like to see a code generation package
that generates a models from existing data base.</p>
</div>
<footer class=post-footer>
<nav class=paginav>
<a class=prev href=http://blog.ralch.com/articles/golang-model-validation/>
<span class=title>« Prev Page</span>
<br>
<span>Data validation in Golang</span>
</a>
<a class=next href=http://blog.ralch.com/articles/golang-embedded-resources/>
<span class=title>Next Page »</span>
<br>
<span>Embedded resources in Golang</span>
</a>
</nav>
<div class=share-buttons>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on twitter" href="https://twitter.com/intent/tweet/?text=Object%20relation%20mapping%20with%20GORM&url=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f&hashtags="><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM195.519 424.544c135.939.0 210.268-112.643 210.268-210.268.0-3.218.0-6.437-.153-9.502 14.406-10.421 26.973-23.448 36.935-38.314-13.18 5.824-27.433 9.809-42.452 11.648 15.326-9.196 26.973-23.602 32.49-40.92-14.252 8.429-30.038 14.56-46.896 17.931-13.487-14.406-32.644-23.295-53.946-23.295-40.767.0-73.87 33.104-73.87 73.87.0 5.824.613 11.494 1.992 16.858-61.456-3.065-115.862-32.49-152.337-77.241-6.284 10.881-9.962 23.601-9.962 37.088.0 25.594 13.027 48.276 32.95 61.456-12.107-.307-23.448-3.678-33.41-9.196v.92c0 35.862 25.441 65.594 59.311 72.49-6.13 1.686-12.72 2.606-19.464 2.606-4.751.0-9.348-.46-13.946-1.38 9.349 29.426 36.628 50.728 68.965 51.341-25.287 19.771-57.164 31.571-91.8 31.571-5.977.0-11.801-.306-17.625-1.073 32.337 21.15 71.264 33.41 112.95 33.41z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on linkedin" href="https://www.linkedin.com/shareArticle?mini=true&url=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f&title=Object%20relation%20mapping%20with%20GORM&summary=Object%20relation%20mapping%20with%20GORM&source=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM160.461 423.278V197.561h-75.04v225.717h75.04zm270.539.0V293.839c0-69.333-37.018-101.586-86.381-101.586-39.804.0-57.634 21.891-67.617 37.266v-31.958h-75.021c.995 21.181.0 225.717.0 225.717h75.02V297.222c0-6.748.486-13.492 2.474-18.315 5.414-13.475 17.767-27.434 38.494-27.434 27.135.0 38.007 20.707 38.007 51.037v120.768H431zM123.448 88.722C97.774 88.722 81 105.601 81 127.724c0 21.658 16.264 39.002 41.455 39.002h.484c26.165.0 42.452-17.344 42.452-39.002-.485-22.092-16.241-38.954-41.943-39.002z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on reddit" href="https://reddit.com/submit?url=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f&title=Object%20relation%20mapping%20with%20GORM"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zM446 265.638c0-22.964-18.616-41.58-41.58-41.58-11.211.0-21.361 4.457-28.841 11.666-28.424-20.508-67.586-33.757-111.204-35.278l18.941-89.121 61.884 13.157c.756 15.734 13.642 28.29 29.56 28.29 16.407.0 29.706-13.299 29.706-29.701.0-16.403-13.299-29.702-29.706-29.702-11.666.0-21.657 6.792-26.515 16.578l-69.105-14.69c-1.922-.418-3.939-.042-5.585 1.036-1.658 1.073-2.811 2.761-3.224 4.686l-21.152 99.438c-44.258 1.228-84.046 14.494-112.837 35.232-7.468-7.164-17.589-11.591-28.757-11.591-22.965.0-41.585 18.616-41.585 41.58.0 16.896 10.095 31.41 24.568 37.918-.639 4.135-.99 8.328-.99 12.576.0 63.977 74.469 115.836 166.33 115.836s166.334-51.859 166.334-115.836c0-4.218-.347-8.387-.977-12.493 14.564-6.47 24.735-21.034 24.735-38.001zM326.526 373.831c-20.27 20.241-59.115 21.816-70.534 21.816-11.428.0-50.277-1.575-70.522-21.82-3.007-3.008-3.007-7.882.0-10.889 3.003-2.999 7.882-3.003 10.885.0 12.777 12.781 40.11 17.317 59.637 17.317 19.522.0 46.86-4.536 59.657-17.321 3.016-2.999 7.886-2.995 10.885.008 3.008 3.011 3.003 7.882-.008 10.889zm-5.23-48.781c-16.373.0-29.701-13.324-29.701-29.698.0-16.381 13.328-29.714 29.701-29.714 16.378.0 29.706 13.333 29.706 29.714.0 16.374-13.328 29.698-29.706 29.698zM160.91 295.348c0-16.381 13.328-29.71 29.714-29.71 16.369.0 29.689 13.329 29.689 29.71.0 16.373-13.32 29.693-29.689 29.693-16.386.0-29.714-13.32-29.714-29.693z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on facebook" href="https://facebook.com/sharer/sharer.php?u=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H342.978V319.085h66.6l12.672-82.621h-79.272v-53.617c0-22.603 11.073-44.636 46.58-44.636H425.6v-70.34s-32.71-5.582-63.982-5.582c-65.288.0-107.96 39.569-107.96 111.204v62.971h-72.573v82.621h72.573V512h-191.104c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on whatsapp" href="https://api.whatsapp.com/send?text=Object%20relation%20mapping%20with%20GORM%20-%20http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f"><svg viewBox="0 0 512 512"><path d="M449.446.0C483.971.0 512 28.03 512 62.554v386.892C512 483.97 483.97 512 449.446 512H62.554c-34.524.0-62.554-28.03-62.554-62.554V62.554c0-34.524 28.029-62.554 62.554-62.554h386.892zm-58.673 127.703c-33.842-33.881-78.847-52.548-126.798-52.568-98.799.0-179.21 80.405-179.249 179.234-.013 31.593 8.241 62.428 23.927 89.612l-25.429 92.884 95.021-24.925c26.181 14.28 55.659 21.807 85.658 21.816h.074c98.789.0 179.206-80.413 179.247-179.243.018-47.895-18.61-92.93-52.451-126.81zM263.976 403.485h-.06c-26.734-.01-52.954-7.193-75.828-20.767l-5.441-3.229-56.386 14.792 15.05-54.977-3.542-5.637c-14.913-23.72-22.791-51.136-22.779-79.287.033-82.142 66.867-148.971 149.046-148.971 39.793.014 77.199 15.531 105.329 43.692 28.128 28.16 43.609 65.592 43.594 105.4-.034 82.149-66.866 148.983-148.983 148.984zm81.721-111.581c-4.479-2.242-26.499-13.075-30.604-14.571-4.105-1.495-7.091-2.241-10.077 2.241-2.986 4.483-11.569 14.572-14.182 17.562-2.612 2.988-5.225 3.364-9.703 1.12-4.479-2.241-18.91-6.97-36.017-22.23C231.8 264.15 222.81 249.484 220.198 245s-.279-6.908 1.963-9.14c2.016-2.007 4.48-5.232 6.719-7.847 2.24-2.615 2.986-4.484 4.479-7.472 1.493-2.99.747-5.604-.374-7.846-1.119-2.241-10.077-24.288-13.809-33.256-3.635-8.733-7.327-7.55-10.077-7.688-2.609-.13-5.598-.158-8.583-.158-2.986.0-7.839 1.121-11.944 5.604-4.105 4.484-15.675 15.32-15.675 37.364.0 22.046 16.048 43.342 18.287 46.332 2.24 2.99 31.582 48.227 76.511 67.627 10.685 4.615 19.028 7.371 25.533 9.434 10.728 3.41 20.492 2.929 28.209 1.775 8.605-1.285 26.499-10.833 30.231-21.295 3.732-10.464 3.732-19.431 2.612-21.298-1.119-1.869-4.105-2.99-8.583-5.232z"/></svg>
</a>
<a target=_blank rel="noopener noreferrer" aria-label="share Object relation mapping with GORM on telegram" href="https://telegram.me/share/url?text=Object%20relation%20mapping%20with%20GORM&url=http%3a%2f%2fblog.ralch.com%2farticles%2fgolang-object-relation-mapping-with-gorm%2f"><svg viewBox="2 2 28 28"><path d="M26.49 29.86H5.5a3.37 3.37.0 01-2.47-1 3.35 3.35.0 01-1-2.47V5.48A3.36 3.36.0 013 3 3.37 3.37.0 015.5 2h21A3.38 3.38.0 0129 3a3.36 3.36.0 011 2.46V26.37a3.35 3.35.0 01-1 2.47 3.38 3.38.0 01-2.51 1.02zm-5.38-6.71a.79.79.0 00.85-.66L24.73 9.24a.55.55.0 00-.18-.46.62.62.0 00-.41-.17q-.08.0-16.53 6.11a.59.59.0 00-.41.59.57.57.0 00.43.52l4 1.24 1.61 4.83a.62.62.0 00.63.43.56.56.0 00.4-.17L16.54 20l4.09 3A.9.9.0 0021.11 23.15zM13.8 20.71l-1.21-4q8.72-5.55 8.78-5.55c.15.0.23.0.23.16a.18.18.0 010 .06s-2.51 2.3-7.52 6.8z"/></svg>
</a>
</div>
</footer>
</article>
</main>
<footer class=footer>
<span>(c) 2021 Svetlin Ralchev</span>
<span>
Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a>
</span>
</footer>
<a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a>
<script>let menu=document.getElementById('menu');menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)},document.querySelectorAll('a[href^="#"]').forEach(a=>{a.addEventListener("click",function(b){b.preventDefault();var a=this.getAttribute("href").substr(1);window.matchMedia('(prefers-reduced-motion: reduce)').matches?document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(a)}']`).scrollIntoView({behavior:"smooth"}),a==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${a}`)})})</script>
<script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script>
<script>document.querySelectorAll('pre > code').forEach(b=>{const c=b.parentNode.parentNode,a=document.createElement('button');a.classList.add('copy-code'),a.innerText='copy';function d(){a.innerText='copied!',setTimeout(()=>{a.innerText='copy'},2e3)}a.addEventListener('click',e=>{if('clipboard'in navigator){navigator.clipboard.writeText(b.textContent),d();return}const a=document.createRange();a.selectNodeContents(b);const c=window.getSelection();c.removeAllRanges(),c.addRange(a);try{document.execCommand('copy'),d()}catch(a){}c.removeRange(a)}),c.classList.contains("highlight")?c.appendChild(a):c.parentNode.firstChild==c||(b.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?b.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(a):b.parentNode.appendChild(a))})</script>
</body>
</html>